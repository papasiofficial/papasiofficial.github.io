<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tambah Nama dengan SQLite</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.2/sql-wasm.min.js"></script>
</head>
<body>
  <h1>Tambah Nama ke Database SQLite</h1>

  <!-- Input dan tombol -->
  <input id="name" type="text" placeholder="Masukkan nama" />
  <button id="addNameButton">Tambah Nama</button>

  <!-- Tempat menampilkan nama -->
  <h2>Nama yang ditambahkan:</h2>
  <ul id="nameList"></ul>

  <script>
    let SQL, db;

    // Fungsi untuk inisialisasi SQL.js dan membuat DB
    async function initDB() {
      SQL = await initSqlJs({
        locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.2/${file}`
      });

      db = new SQL.Database();
      
      // Membuat tabel jika belum ada
      db.run(`
        CREATE TABLE IF NOT EXISTS names (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          name TEXT NOT NULL
        );
      `);
      
      // Memuat data dari DB saat pertama kali
      loadNames();
    }

    // Fungsi untuk menambahkan nama ke database
    function addName() {
      const nameInput = document.getElementById("name");
      const name = nameInput.value.trim();
      
      // Validasi nama
      if (name === "") {
        alert("Nama tidak boleh kosong!");
        return;
      }
      
      // Menyimpan nama ke dalam database
      const stmt = db.prepare("INSERT INTO names (name) VALUES (?)");
      stmt.run([name]);
      stmt.free();
      
      // Kosongkan input setelah menambah
      nameInput.value = "";
      
      // Tampilkan data terbaru
      loadNames();
    }

    // Fungsi untuk memuat dan menampilkan nama dari database
    function loadNames() {
      const nameList = document.getElementById("nameList");
      nameList.innerHTML = "";  // Bersihkan daftar sebelumnya

      // Ambil data dari database
      const res = db.exec("SELECT * FROM names");
      
      if (res.length > 0) {
        res[0].values.forEach(row => {
          const listItem = document.createElement("li");
          listItem.textContent = row[1];  // Ambil kolom nama
          nameList.appendChild(listItem);
        });
      }
    }

    // Event listener untuk tombol tambah nama
    document.getElementById("addNameButton").onclick = addName;

    // Inisialisasi database saat halaman dimuat
    initDB();
  </script>
</body>
</html>
